"use strict";const t=require("../common/vendor.js");function n(t){const n=t&&t.touches&&t.touches[0]||t&&t.changedTouches&&t.changedTouches[0]||{};return{x:n.clientX??n.pageX??n.x??0,y:n.clientY??n.pageY??n.y??0}}exports.useEdgeExit=function(e={}){const{showHint:i,onExit:c,confirmWindow:o=2e3,edgeDp:a=16}=e||{},s=t.index.getSystemInfoSync&&t.index.getSystemInfoSync()?t.index.getSystemInfoSync():{},r=s.windowWidth||0,u=s.pixelRatio||1,l=Math.max(12,Math.round(a*(Number.isFinite(u)&&u>0?u:1))),d={tracking:!1,startX:0,startY:0,lastDX:0,lastDY:0,isEdge:!1};let h=null,f=0;function g(){d.tracking=!1,d.isEdge=!1,d.lastDX=0,d.lastDY=0}return t.onUnmounted((()=>{h&&(clearTimeout(h),h=null)})),{handleTouchStart:function(t){const{x:e,y:i}=n(t);d.tracking=!0,d.startX=e,d.startY=i,d.lastDX=0,d.lastDY=0,d.isEdge=e<=l||r&&e>=r-l},handleTouchMove:function(t){if(!d.tracking)return;const{x:e,y:i}=n(t);d.lastDX=e-d.startX,d.lastDY=i-d.startY},handleTouchEnd:function(){if(!d.tracking)return;const n=d.lastDX,e=d.lastDY,a=d.isEdge;if(g(),!a)return;const s=Math.abs(n),r=Math.abs(e);s<60||s<=1.2*r||function(){const n=Date.now();if(h&&n<=f){clearTimeout(h),h=null,f=0;try{c&&c()}catch(e){}try{t.index.$emit&&t.index.$emit("edge_exit_confirm_exit")}catch(e){}}else if(f=n+o,h&&(clearTimeout(h),h=null),h=setTimeout((()=>{h=null,f=0}),o),"function"==typeof i){try{t.index.$emit&&t.index.$emit("edge_exit_hint_shown")}catch(e){}i("再次从屏幕边缘滑动即可退出",{duration:2e3,interactive:!1})}}()},handleTouchCancel:function(){g()}}};
